<!-- outfit-body-panel-v1.html -->

<style>

    #outfit-editor-panel {
        width:100% !important;
        min-width:100% !important;
        max-width:100% !important; 
        min-height:550px !important;
        max-height:550px !important; 
        background-color:#000000;
    }

    .col-panel {
        height:auto; 
        border:black 1px solid;
        padding-top:0px; padding-bottom:0px;
        color:#ffffff;
    }

    .col-panel a { color:#ffffff; }
    .sp-container { width:100%; background-color:#000000; border:none; }
    .sp-input { color:#ffffff; border:none; }
    .sp-picker-container { width:90%; border:none; }

    .action-controls-output { 
        width:50px; outline:none; /* margin-right:10px; */
        color:#ffffff; border:none; background-color:rgba(255,255,255,0); 
        font-weight:bold; font-size:1em; text-align:right; font-family:Arial;
    }
</style>


<div id="outfit-body-select-gender-col" class="col-md-6 col-panel">
    <h4>Select gender:</h4>

    <a id="gender-male" name="male" class="nav-link btn btn-default btn-white-outline avatar-btn" 
    style="width:79px; height:79px; background-image: url('/img/hmHead.png'); background-size: 
    contain; background-position:50% 50%; background-repeat:no-repeat;" title="Male"></a>

    <a id="gender-female" name="female" class="nav-link btn btn-default btn-white-outline avatar-btn" 
    style="width:79px; height:79px; background-image: url('/img/fmHead.png'); background-size: 
    contain; background-position:50% 50%; background-repeat:no-repeat;" title="Female"></a>

    <a id="gender-reset" class="nav-link btn btn-default btn-white-outline avatar-btn" 
    style="width:79px; height:79px; background-image: url('/img/skull-head.png'); background-size: 
    contain; background-position:50% 50%; background-repeat:no-repeat;" title="Skeleton"></a>

</div>

<div id="outfit-body-male-skin-col" class="col-md-6 col-panel">
    <h4>Select male skintone:</h4>

    <a id="skin-map-hmSkinLight" name="hmSkinLight" class="nav-link btn btn-default btn-white-outline skin-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/hmSkinLight.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Skin: hmSkinLight"></a>

    <a id="skin-map-hmSkinMedium" name="hmSkinMedium" class="nav-link btn btn-default btn-white-outline skin-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/hmSkinMedium.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Skin: hmSkinMedium"></a>

    <a id="skin-map-hmSkinDark" name="hmSkinDark" class="nav-link btn btn-default btn-white-outline skin-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/hmSkinDark.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Skin: hmSkinDark"></a>

</div>

<div id="outfit-body-import-skin-col" class="col-md-6 col-panel">
    <h4>Import skin texture:</h4>

    <a id="gender-doll" name="fmDoll" class="nav-link btn btn-default btn-white-outline avatar-btn" 
    style="width:79px; height:79px; background-image: url('/img/alien-head128x128.png'); background-size: 
    contain; background-position:50% 50%; background-repeat:no-repeat; display:none;" title="Doll"></a>

    <a id="cataloge-skin-map" name="import-skin-map" class="nav-link btn btn-default btn-white-outline import-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/icon_cat128x128.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Open catalogue"></a>

    <a id="desktop-skin-map" name="import-skin-map" class="nav-link btn btn-default btn-white-outline import-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/import-texture100x100.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Import from desktop"></a>

    <a id="web-skin-map" name="import-skin-map" class="nav-link btn btn-default btn-white-outline import-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/from-internet-texture100x100.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Import from internet"></a>

    <a id="remove-skin-map" name="remove-skin-texture" class="nav-link btn btn-default btn-white-outline remove-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/delete-texture100x100.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat; display:none;" title="Remove skin texture"></a>

</div>

<div id="outfit-body-female-skin-col" class="col-md-6 col-panel" style="height:auto;">
    <h4>Select female skintone:</h4>

    <a id="skin-map-fmSkinLight" name="fmSkinLight" class="nav-link btn btn-default btn-white-outline skin-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/fmSkinLight.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Skin: fmSkinLight"></a>

    <a id="skin-map-fmSkinMedium" name="fmSkinMedium" class="nav-link btn btn-default btn-white-outline skin-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/fmSkinMedium.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Skin: fmSkinMedium"></a>

    <a id="skin-map-fmSkinDark" name="fmSkinDark" class="nav-link btn btn-default btn-white-outline skin-texture-btn" 
    style="width:79px; height:79px; background-image: url('/img/fmSkinDark.png'); background-size: contain; 
    background-position:50% 50%; background-repeat:no-repeat;" title="Skin: fmSkinDark"></a>

</div>

<div id="outfit-body-diffuse-col" class="col-md-6 col-panel">
    <h4>Skin tone (color):</h4>
    <input type="hidden" id="sp-body-color">
</div>

<div id="outfit-body-emissive-col" class="col-md-6 col-panel">
    <h4>Skin color (emissive):</h4>
    <input type="hidden" id="sp-body-emissive">
</div>


<script>

    debugMode && console.log( "target:", target == localPlayer.outfit.body );

    var genderMaleSelector   = "#gender-male";
    var genderFemaleSelector = "#gender-female";
    var genderResetSelector  = "#gender-reset";
    var genderDollSelector   = "#gender-doll";
    
    $(genderMaleSelector).on("click", function(){
        var outfit = localPlayer.outfit;
        outfit.removeFromScene();
        outfit.setGender("male");

        outfit.add( 
            {"skeleton": Avatars[ "skeleton" ]},
            {"body":     Avatars[ "hmBody" ]},
            {"hairs":    Avatars[ "hmHairs" ]},
            {"tshirt":   Avatars[ "hmTshirt" ]},
            {"trousers": Avatars[ "hmTrousers" ]},
            {"shoes":    Avatars[ "hmSneakers" ]}
        );
        outfit.direction.scale.set(1.04, 1.04, 1.04); // IMPORTANT //
        outfit.skeleton.visible = false;

        updateBodyColorpickers();
    });

    $(genderFemaleSelector).on("click", function(){
        var outfit = localPlayer.outfit;
        outfit.removeFromScene();
        outfit.setGender("female");

        outfit.add( 
            {"skeleton": Avatars[ "skeleton" ]},
            {"body"    : Avatars[ "fmBody" ]},
            {"hairs"   : Avatars[ "fmHairs" ]},
            {"dress"   : Avatars[ "fmDress" ]},
            {"shoes"   : Avatars[ "fmSandal" ]}
        );
        outfit.direction.scale.set(1, 1, 1); // IMPORTANT //
        outfit.skeleton.visible = false;

        updateBodyColorpickers();
    });

    $(genderResetSelector).on("click", function(){
        var outfit = localPlayer.outfit;
        outfit.removeFromScene();
        outfit.resetGender();

        outfit.add({"skeleton": Avatars["skeleton"]});
        outfit.direction.scale.set(1, 1, 1); // IMPORTANT //
        outfit.skeleton.visible = true;

        updateBodyColorpickers();
    });

</script>


<script>

//  Skin Spectrum Colorpickers.js

    var bodySpectrumColorSelector    = "#sp-body-color";
    var bodySpectrumEmissiveSelector = "#sp-body-emissive";
    
    $(bodySpectrumColorSelector).spectrum({
        preferredFormat: "hex",
        color: "#ffffff",
        flat: true,
        showInput: true,
        showInitial: true,
        showButtons: false,
        allowEmpty: false,
        move: function(color) {
            var body, material;

            body = localPlayer.outfit.body;
            if ( !!body.material.materials )
                material = body.material.materials[0];
            else 
                material = body.material;
            if (!material) return;

            var hex = color.toString("hex").replace(/#/, "0x");
            material.color.setHex( hex );
        }
    });

    $(bodySpectrumEmissiveSelector).spectrum({
        preferredFormat: "hex",
        color: "#000000",
        flat: true,
        showInput: true,
        showInitial: true,
        showButtons: false,
        allowEmpty: false,
        move: function(color) {
            var body, material;

            body = localPlayer.outfit.body;
            if ( !!body.material.materials )
                material = body.material.materials[0];
            else 
                material = body.material;
            if (!material) return;

            var hex = color.toString("hex").replace(/#/, "0x");
            material.emissive.setHex( hex );
        }
    });

    $(bodySpectrumColorSelector).on("dragstop.spectrum", function(e, color) {
   //  debugMode && console.log( "diffuse color on dragstop:", color.toHexString() );        
        if ( !target) {
            $(this).spectrum( "set", "#ffffff" ); 
            return;
        }
    });

    $(bodySpectrumEmissiveSelector).on("dragstop.spectrum", function(e, color) {
    //  debugMode && console.log( "emissive color on dragstop:", emissive.toHexString() );
        if ( !target) {
            $(this).spectrum( "set", "#000000" );
            return;
        }
    });

    updateBodyColorpickers();

    function updateBodyColorpickers(){
    //  Colorpickers update.
        var body, material;

        body = localPlayer.outfit.body;
        if ( !!body.material.materials )
            material = body.material.materials[0];
        else 
            material = body.material;
        if (!material) return;

        $(bodySpectrumColorSelector).spectrum( "set", material.color.getHexString() );
        $(bodySpectrumEmissiveSelector).spectrum( "set", material.emissive.getHexString() );
    }

</script>


<script>

    $OutfitEditorPanel.dialog( "option", {
        width: 600,
        minWidth: 600,
        maxWidth: 600,
        height: 600,
        minHeight: 600,
        maxHeight: 600
    });

//  Open dialog.
    $OutfitEditorPanel.dialog("open");

</script>
